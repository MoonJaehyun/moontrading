import datetime
import time
import webbrowser
from bs4 import BeautifulSoup
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager
import keyboard
import urllib.parse 

def setup_driver():
    options = Options()
    options.headless = True
    driver = webdriver.Chrome(ChromeDriverManager().install(), options=options)
    driver.implicitly_wait(3)
    return driver

def get_stock_post_counts(driver, stock_codes, date):
    pocket = []
    for s in stock_codes:
        검색어 = '리튬'
        encoded_text = urllib.parse.quote(검색어.encode('euc-kr'))
        url = f"https://finance.naver.com/item/board.naver?code={s}&st=title&sw={encoded_text}"
        driver.get(url)
        html = driver.page_source
        soup = BeautifulSoup(html, 'html.parser')
        date_elements = soup.select('span.tah.p10.gray03')

        loop_count = 0
        for j in range(0, len(date_elements)):
            post_date = date_elements[j].text.strip().split()[0]
            if post_date == date:
                loop_count += 1
        if loop_count > 0:
            pocket.append(f"{s}-조회수:{loop_count}")
    return pocket

def open_url_on_space_key(urls):
    print("Press space to open a URL or 'q' to quit.")
    index = 0
    while index < len(urls):
        time.sleep(0.05)
        if keyboard.is_pressed(" "):
            webbrowser.open(urls[index], new=0)
            index += 1
            while keyboard.is_pressed(" "):
                time.sleep(0.05)
        elif keyboard.is_pressed("q"):
            break

def main():
    stock_codes = ['174880', '139050', '068330', '039310', '091970', '200780', '151910', '117670', '014100', '043090', '083470', '114810', '056000', '227950', '051980', '219550', '082800', '021045', '08537M', '023460', '071850', '079000', '051390', '173940', '027040', '018680', '226340', '019010', '049120', '070590', '019540', '043340', '008290', '043710', '021650', '091340', '318410', '002800', '036480', '221980', '017250', '045510', '038060', '025870', '098660', '065060', '033200', '376290', '044480', '131180', '097780', '032280', '069510', '024830', '191410', '359090', '032685', '048830', '008830', '093380', '036000', '016670', '335870', '032800', '079950', '103840', '035620', '021040', '323230', '003800', '050760', '154040', '092130', '140520', '065690', '040610', '064820', '215790', '065500', '025440', '026040', '123840', '001540', '080010', '033050', '044180', '088910', '353190', '332570', '106190', '376190', '060480', '021880', '050090', '255220', '192390', '033830', '009620', '225590', '023790', '049550', '054940', '308100', '011080', '130500', '223250', '065170', '079650', '086060', '065420', '195500', '066790', '049470', '018620', '007370', '049630', '101400', '034940', '016600', '001000', '318010', '053160', '037230', '065530', '026910', '031510', '002290', '222040', '085810', '330730', '025950', '001810', '215480', '252500', '019770', '169330', '224060', '204020', '038620', '137940', '024910', '017510', '023770', '050120', '099410', '016920', '290120', '237820', '267790', '115570', '078940', '001840', '348030', '038870', '016100', '066430', '072470', '006920', '033540', '078070', '006050', '161570', '014970', '037400', '042040', '025880', '221840', '002680', '036630', '127710', '052670', '039980', '053350', '023900', '024840', '071200', '138070', '073110', '046310', '002230', '171120', '250000', '094970', '313760', '036170', '115530', '036620', '383930', '332370', '205500', '122450', '079970', '050860', '208640', '067290', '043220', '228340', '064090', '195990', '039740', '263920', '020180', '227100', '052420', '060540', '067730', '044960', '049520', '052460', '031310', '219130', '052790', '053290', '057680', '044490', '081580', '082210', '066910', '046070', '032580', '060570', '114450', '010280', '019570', '041590', '052260', '057030', '339950', '036690', '053450', '007530', '018700', '032540', '361570', '036090', '027050', '054180', '193250', '123570', '095190', '073190', '076610', '061040', '090410', '054540', '085910', '200230', '142280', '017000', '060310', '065650', '159910', '019660', '097870', '058450', '057540', '089230', '353810', '080470', '086710', '053300', '053950', '377460', '086980', '039610', '012860', '092300', '039420', '047080', '045300', '078860', '095910', '027580', '053060', '234300', '100660', '032960', '139670', '049830', '217270', '100030', '105550', '289010', '102940', '094850', '026150', '200470', '051370', '096690', '053270', '115180', '043910', '035290', '201490', '082850', '013720', '273060', '104200', '377450', '064240', '019990', '035080', '052220', '039860', '097800', '104620', '038880', '042510', '299170', '069920', '331520', '007820', '052300', '138360', '060900', '101330', '018000', '054800', '290380', '089150', '038680', '036180', '036030', '239340', '052330', '033170', '122350', '089530', '052600', '314140', '033230', '014470', '038010', '024740', '035610', '066980', '064520', '111870', '122690', '130740', '050110', '061250', '131760', '160550', '134580', '115450', '047820', '058820', '144960', '419120', '068050', '408920', '053700', '347740', '162300', '067390', '136480', '214270', '096610', '063440', '033130', '241840', '088800', '046390', '010170', '263770', '084180', '051500', '046120', '011320', '177350', '003310', '060370', '030350', '047770', '013810', '054620', '032680', '096040', '119500', '041460', '109610', '032980', '054780', '099220', '006730', '417180', '019210', '106520', '356860', '123040', '025320', '207760', '009730', '204630', '263700', '080160', '230360', '127980', '222810', '083650', '052710', '173130', '079170', '263720', '042940', '310200', '196450', '049480', '263810', '014620', '366030', '041440', '044060', '082660', '161580', '148930', '073640', '005860', '237880', '217620', '119830', '090150', '085670', '013990', '340570', '264850', '024850', '033640', '263800', '108230', '362320', '025980', '115160', '380540', '006910', '298870', '260930', '227610', '028080', '043590', '254490', '066590', '090470', '101390', '131100', '063170', '048550', '033310', '060590', '182360', '051780', '051490', '441270', '072520', '072770', '215600', '291230', '299900', '042520', '190510', '101730', '023440', '052020', '075970', '036010', '030960', '388050', '198940', '124500', '085370', '389260', '099440', '353590', '060720', '031860', '007390', '115500', '137080', '048410', '140410', '060230', '391710', '056080', '038110', '171090', '029480', '088290', '096630', '419050', '090710', '036120', '079810', '222080', '118990', '067310', '045970', '140670', '076080', '086960', '037370', '060280', '417970', '282720', '024880', '320000', '403870', '037950', '090360', '382840', '114190', '073570', '024800', '130580', '018120', '005710', '264660', '005670', '008370', '065710', '053620', '009780', '017650', '038390', '241770', '066900', '065130', '014570', '017480', '034950', '036190', '012620', '045060', '008470', '03481K', '041520', '004780', '270870', '126640', '037330', '007680', '020710', '048470', '005990', '092870', '092460', '037350', '024060', '014940', '040420', '023910', '198080', '068930', '153490', '004650', '092730', '023600', '037760', '072990', '053280', '212560', '122990', '016250', '039830', '119850', '078140', '083550', '239610', '225190', '190650', '011370', '036670', '007720', '021320', '060380', '255440', '046940', '014190', '043260', '109860', '066620', '010240', '038460', '024120', '054050', '214180', '234690', '063570', '043370', '067170', '143240', '011040', '263690', '032750', '067900', '100700', '198440', '122310', '084110', '089850', '041910', '348350', '228850', '078020', '042500', '133750', '083310', '065680', '009300', '012700', '013120', '058400', '264450', '136540', '306040', '093190', '054950', '290720', '049430', '110990', '121440', '043650', '045660', '260660', '007770', '053260', '120240', '053980', '000440', '037460', '238090', '200670', '234340', '138080', '092190', '101930', '241710', '045100', '039020', '012790', '155650', '236200', '056360', '330350', '040160', '215360', '067570', '039340', '042370', '023760', '024950', '015710', '290550', '038500', '084850', '108380', '043610', '038290', '065510', '110790', '251370', '187870', '036710', '068790', '018310', '048430', '251970', '025550', '017890', '067990', '189980', '034810', '100120', '337930', '084730', '039240', '043150', '032300', '054670', '290520', '089970', '089600', '123410', '067280', '088130', '064290', '053580', '033320', '131030', '149950', '192440', '096240', '052400', '141000', '041920', '105740', '067080', '267980', '036800', '080420', '078350', '143160', '021080', '208140', '031330', '023410', '071280', '194700', '027710', '081150', '093320', '079940', '030530', '091590', '011560', '206640', '035810', '073490', '086670', '241690', '042110', '241790', '006620', '051160', '069080', '037070', '100590', '060560', '033500', '100130', '029960', '079960', '006140', '073560', '090850', '051380', '007330', '048910', '102710', '056700', '225530', '124560', '126600', '039440', '307750', '038070', '036640', '093520', '086450', '160980', '065950', '183300', '238490', '030190', '066700', '232140', '104480', '039840', '035890', '010470', '038540', '243070', '099190', '115960', '126880', '119860', '092070', '032620', '061970', '066130', '041930', '067000', '086390', '053050', '022220', '064800', '080000', '013030', '091700', '060150', '053030', '051360', '101160', '104830', '159580', '045390', '119610', '036830', '234100', '046890', '099320', '083450', '106240', '042420', '040300', '046140', '035600', '084650', '018290', '071460', '170030', '131290', '040910', '123420', '045520', '265520', '050890', '218410', '053080', '214450', '066670', '200130', '037440', '137950', '298540', '039010', '041830', '023160', '140070', '094820', '077360', '064260', '046440', '065450', '262260', '140860', '089980', '094480', '126700', '104460', '267320', '204270', '089030', '032500', '025770', '095340', '053610', '083930', '084370', '128660', '060250', '217820', '166090', '215000', '100790', '102120', '013310', '144510', '036810', '215200', '022100', '036560', '049720', '036890', '039030', '063080', '131970', '319400', '053800', '093920', '033290', '080220', '082920', '041190', '047310', '074600', '079370', '178320', '194480', '297090', '243840', '228670', '189300', '095660', '263600', '054210', '015750', '044340', '089890', '039290', '033160', '091120', '088390', '095610', '222800', '036540', '317330', '319660', '078150', '042600', '089010', '148150', '078890', '036200', '067160', '151860', '030520', '078340', '272290', '090460', '101490', '065350', '200710', '282880', '005160', '091580', '205470', '036930', '071670', '281740', '059090', '101360', '049070', '058610', '009520', '095500', '950110', '900260', '900070', '900270', '900120', '900100', '900340', '900310', '950140', '900250', '950200', '900110', '950190', '900300', '950220', '950130', '900280', '900290', '080530', '175140', '215380', '131090', '065770', '020400', '070300', '352940', '060260', '134060', '067770', '043200', '043360', '035200', '265740', '147760', '087600', '065150', '208350', '225430', '317240', '054410', '073540', '290690', '317770', '069330', '072950', '111710', '069140', '032080', '290270', '043100', '045340', '168330', '094840', '101240', '222980', '340360', '072870', '187220', '277410', '369370', '333050', '096870', '049960', '062970', '237750', '044780', '059100', '115610', '332290', '052860', '098120', '123330', '290740', '147830', '217190', '080720', '113810', '052900', '256630', '262840', '038950', '075130', '064850', '153460', '004590', '095270', '154030', '170790', '297570', '032940', '092600', '089790', '258610', '060850', '256150', '148250', '328380', '094860', '177830', '054040', '260970', '263020', '310870', '072020', '275630', '311390', '073010', '096350', '192410', '203690', '129890', '307280', '250930', '104040', '156100', '091440', '187660', '203450', '065570', '208710', '158430', '054220', '197140', '206400', '246690', '035460', '357230', '080520', '069410', '184230', '307180', '066310', '031980', '054300', '046210', '189690', '032790', '109740', '083640', '122640', '196700', '302430', '307870', '333430', '063760', '214430', '115480', '253590', '019550', '089140', '171010', '142210', '069540', '331380', '224110', '012340', '059210', '131370', '074430', '185490', '290090', '293580', '191420', '039560', '079190', '150900', '033560', '218150', '115310', '024940', '226360', '027830', '230980', '189860', '080580', '114840', '136410', '289080', '368770', '032850', '365900', '303530', '027360', '149980', '186230', '192250', '199820', '336060', '356890', '425420', '050960', '263860', '128540', '105330', '040350', '163730', '388790', '220180', '046970', '405100', '048870', '083500', '251630', '138580', '159010', '086040', '146320', '060240', '078160', '109080', '187270', '216050', '296640', '322780', '054630', '143540', '067920', '285490', '372800', '024810', '187790', '307930', '327260', '323280', '368970', '123750', '322310', '303030', '049080', '041960', '054930', '352480', '347770', '258790', '330860', '019590', '382900', '277070', '367000', '032820', '256840', '047560', '261200', '067010', '288620', '203650', '048770', '099390', '082270', '114630', '294570', '065440', '164060', '351320', '241520', '241820', '049180', '068240', '094170', '179290', '309930', '273640', '419540', '312610', '306620', '115440', '033100', '373200', '217500', '382800', '085660', '126340', '363260', '039200', '199730', '287410', '205100', '094940', '259630', '215100', '351330', '290650', '417500', '054090', '272110', '333620', '408900', '099750', '317850', '257720', '099430', '204620', '123860', '256940', '347890', '058630', '230240', '054920', '278650', '195940', '376180', '214680', '265560', '168360', '340440', '297890', '417840', '170920', '234920', '179900', '059120', '335890', '389140', '382480', '101170', '340930', '131220', '356680', '396300', '094360', '054450', '121800', '321260', '037030', '222420', '129920', '041020', '117730', '121850', '258830', '204610', '318000', '348370', '220260', '417010', '300120', '317830', '322180', '131400', '107600', '196490', '246720', '087260', '093640', '211270', '360070', '399720', '407400', '270520', '049950', '299030', '065370', '388720', '208370', '270660', '064480', '290670', '101670', '108860', '204840', '246960', '222110', '294630', '311690', '335810', '347000', '153710', '179530', '286750', '331920', '196300', '238120', '314930', '067370', '110020', '222160', '322510', '229000', '084440', '244460', '290660', '086820', '361670', '344860', '208340', '250060', '291650', '354200', '252990', '377220', '302550', '058110', '148780', '317690', '389470', '347700', '352700', '217730', '276730', '308080', '166480', '389030', '365270', '211050', '288330', '238200', '187420', '253840', '311320', '317120', '376980', '123010', '225220', '299660', '087010', '321550', '321820', '214260', '284620', '183490', '217330', '317530', '245620', '412350', '251120', '138610', '109820', '226400', '203400', '127120', '220100', '263050', '199800', '226330', '102370', '317870', '086890', '048530', '370090', '104540', '363250', '348150', '376930', '261780', '083790', '112290', '200350', '065660', '314130', '279600', '226950', '142760', '206560', '092040', '206650', '305090', '310210', '361390', '377330', '228760', '397030', '298060', '095700', '389020', '377030', '293780', '246710', '242040', '174900', '315640', '084990', '239890', '276040', '216080', '289220', '425040', '274090', '368600', '352910', '301300', '348210', '047920', '300080', '235980', '042000', '254120', '291810', '338220', '334970', '336570', '357880', '175250', '232680', '411080', '219420', '247660', '236810', '328130', '357580', '141080', '189330', '396270', '182400', '371950', '405000', '378800', '417860', '298380', '059270', '376300', '419080', '125210', '347860', '214610', '365590', '288980', '268600', '323990', '277880', '304840', '357550', '402030', '394280', '418550', '372170', '419530', '294090', '058970', '352770', '108490', '304100', '377480', '294140', '418420', '389500', '348340', '101000', '950170', '066360', '950160', '083660', '442770', '430230', '413630', '439730', '435380', '393360', '377400', '404950', '433530', '367360', '397880', '424140', '442130', '367340', '406760', '439410', '430700', '419270', '430220', '405640', '440790', '386580', '373340', '418170', '449020', '400840', '445360', '436530', '426550', '440820', '440200', '445970', '430460', '413600', '438580', '412930', '388800', '415580', '437780', '421800', '450410', '353060', '372290', '442310', '435870', '418210', '435620', '427950', '446150', '438220', '391060', '405350', '446750', '446190', '439250', '448740', '442900', '377630', '380320', '424760', '436610', '426670', '388220', '355150', '425290', '396770', '001525', '002787', '002785', '002995', '003465', '001065', '000075', '000547', '004545', '005725', '000227', '000145', '134380', '011155', '000545', '36328K', '005745', '002820', '007575', '001275', '000105', '001527', '075180', '140910', '006345', '145995', '00499K', '014915', '001067', '001270', '002600', '004565', '003460', '014285', '084670', '00806K', '204210', '001725', '108675', '009415', '012205', '26490K', '001685', '005720', '000650', '084695', '004415', '014825', '044820', '001755', '000760', '024070', '005257', '090355', '38380K', '019685', '000087', '069640', '001515', '009770', '350520', '004700', '017900', '004835', '000215', '016800', '005965', '006370', '009140', '000885', '002355', '001465', '143210', '000950', '001750', '021820', '003080', '058650', '003300', '000050', '002025', '006570', '000325', '002420', '010640', '007590', '33637L', '000995', '006805', '016590', '120115', '092230', '107590', '001045', '003535', '025000', '033250', '000850', '012200', '001620', '015360', '000157', '016450', '011230', '007280', '006980', '071320', '000225', '002960', '004840', '001745', '003475', '088790', '155900', '010420', '004080', '003925', '039570', '118000', '007815', '004970', '338100', '009310', '004365', '067830', '37550L', '094800', '003495', '000140', '003830', '071950', '070960', '003075', '163560', '357250', '005305', '025890', '005750', '004985', '272550', '37550K', '101530', '102260', '021050', '003480', '006125', '100250', '008355', '009680', '004105', '168490', '000540', '006090', '010770', '002450', '004450', '093240', '001290', '092440', '034590', '011090', '00279K', '023150', '010040', '009460', '033920', '145270', '078935', '002220', '036530', '025620', '002070', '014440', '002630', '03473K', '35320K', '010400', '001630', '020760', '001795', '008600', '049800', '023000', '001070', '002920', '003280', '078000', '005800', '010145', '001200', '000590', '005820', '004870', '380440', '003547', '002840', '084870', '268280', '000860', '000400', '000320', '227840', '002200', '010960', '02826K', '011280', '014910', '33626K', '072710', '123700', '013870', '282690', '097230', '378850', '001770', '432320', '000680', '005680', '003780', '017180', '002620', '004540', '004440', '00781K', '002795', '037710', '015020', '001420', '404990', '001210', '005430', '035000', '041650', '085310', '030610', '014160', '019680', '025530', '016610', '334890', '003650', '005945', '004255', '009810', '027970', '28513K', '100220', '051630', '000890', '068400', '00680K', '396690', '015590', '090370', '000500', '357430', '012170', '400760', '024720', '003680', '214390', '019180', '034310', '006390', '417310', '001500', '003960', '014130', '010100', '339770', '139990', '155660', '089470', '008775', '002870', '005360', '094280', '123690', '004150', '000155', '018500', '001720', '088260', '00088K', '036580', '001380', '271980', '044380', '002100', '248170', '001560', '267850', '000700', '024890', '012160', '002810', '030720', '33626L', '264900', '005180', '005740', '001520', '001260', '003555', '293480', '017810', '000480', '097955', '002880', '006200', '063160', '004060', '084680', '014790', '079430', '000180', '016580', '004410', '009320', '214320', '226320', '009470', '000430', '001020', '357120', '023960', '33637K', '000970', '009290', '016090', '134790', '029530', '008420', '031440', '129260', '014710', '002460', '001460', '001880', '085620', '012610', '023350', '090080', '002030', '004830', '003160', '001790', '013000', '011760', '092780', '002210', '013520', '027740', '104700', '000040', '096760', '234080', '010955', '028100', '026940', '192400', '069730', '377190', '000725', '004270', '006660', '244920', '009070', '001550', '002390', '003540', '006880', '000300', '084690', '058730', '027410', '002690', '090350', '071055', '267290', '183190', '014530', '115390', '019175', '395400', '017370', '002170', '002360', '012690', '011390', '029460', '006340', '005960', '009200', '133820', '007540', '014280', '002720', '013360', '214330', '100840', '004140', '002320', '000220', '170900', '145990', '214420', '012800', '229640', '007110', '005610', '002990', '013580', '123890', '004920', '009190', '004100', '011330', '002760', '18064K', '900140', '002240', '120030', '194370', '009155', '096775', '025750', '006840', '002310', '024090', '011150', '111110', '008060', '008110', '014990', '004720', '090435', '008250', '023810', '009270', '010660', '300720', '009580', '004090', '004890', '001130', '089860', '013700', '008260', '016740', '008970', '317400', '001360', '004310', '049770', '053210', '060980', '001940', '286940', '093050', '005870', '007160', '044450', '210540', '210980', '102280', '004710', '002780', '034830', '009450', '003000', '009180', '001140', '213500', '057050', '077970', '006490', '000070', '102460', '006060', '003470', '117580', '284740', '003060', '002410', '011785', '005500', '330590', '018250', '017940', '008490', '000520', '009160', '126720', '293940', '017550', '003545', '004910', '000020', '128820', '152550', '007980', '004560', '003240', '306200', '101140', '081000', '008040', '122900', '363280', '009970', '005389', '003220', '020120', '012630', '010580', '034300', '068290', '031820', '004770', '035510', '004960', '026890', '006120', '084010', '003350', '005390', '372910', '000640', '003570', '019440', '025540', '007210', '007690', '095570', '130660', '033180', '145210', '016880', '344820', '004980', '005250', '002020', '001060', '45014K', '108670', '001250', '010050', '002350', '007570', '002140', '003200', '013890', '00104K', '126560', '023450', '033270', '011930', '037270', '007120', '011420', '075580', '073240', '003090', '012280', '082640', '009410', '002700', '000815', '365550', '185750', '010600', '035150', '348950', '007340', '009440', '078520', '095720', '020000', '003070', '136490', '071090', '383800', '003010', '192080', '007700', '005880', '005090', '403550', '281820', '001080', '001510', '003560', '011690', '051905', '003030', '071970', '950210', '006405', '064960', '003920', '001470', '031430', '003120', '000490', '003580', '025860', '058430', '036420', '005030', '066575', '023590', '000910', '007860', '092200', '071840', '001680', '025560', '003520', '000390', '008700', '069260', '097520', '007460', '377740', '000370', '032560', '077500', '119650', '381970', '011700', '298690', '280360', '008870', '017040', '003530', '000230', '069460', '105630', '005320', '161890', '005110', '015230', '003850', '105840', '161000', '241590', '072130', '001820', '003610', '017960', '004430', '079160', '298000', '015860', '002150', '200880', '082740', '446070', '079980', '091090', '450140', '001340', '014830', '308170', '012030', '006890', '294870', '007810', '005690', '004490', '011000', '025820', '033240', '004250', '047400', '249420', '053690', '005810', '010820', '272450', '006740', '267270', '039130', '003720', '058860', '091810', '030210', '298040', '192650', '006380', '033530', '002900', '009420', '192820', '004360', '019170', '003230', '092220', '195870', '011300', '001430', '013570', '037560', '016380', '012510', '055490', '322000', '015260', '034120', '138490', '058850', '010690', '005010', '004380', '008350', '093230', '012320', '001390', '083420', '006220', '011810', '015890', '001530', '103590', '001780', '007660', '023800', '024900', '014580', '074610', '002710', '011500', '018470']
    today = datetime.datetime.now().strftime("%Y.%m.%d")

    driver = setup_driver()
    pocket = get_stock_post_counts(driver, stock_codes, today)
    driver.quit()

    def get_loop_count(item):
        return int(item.split(':')[-1])

    def get_stock_code(item):
        return item.split('-')[0]

    pocket.sort(key=get_loop_count, reverse=True)

    urls = []
    for p in pocket:
        code = get_stock_code(p)
        url = "https://finance.naver.com/item/board.naver?code="+ code
        urls.append(url)

    open_url_on_space_key(urls)
        
if __name__ == "__main__":
    main()
 